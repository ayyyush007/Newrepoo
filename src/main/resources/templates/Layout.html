<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head>
  <meta charset="UTF-8" />
  <title>MovieApp</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <link rel="stylesheet" th:href="@{/css/style.css}" />
</head>
<body>

  <!-- HEADER FRAGMENT -->
  <header class="site-header" th:fragment="siteHeader"
        style="
          position:sticky;
          top:0;
          z-index:60;
          backdrop-filter: blur(10px);
          background: rgba(0,0,0,0.55);
          border-bottom: 1px solid rgba(255,255,255,0.12);
          padding: 10px 0;
        "
        role="banner">

  <div class="inner" style="
        display:flex;
        align-items:center;
        justify-content:space-between;
        gap:1rem;
        padding: 0 1.5rem;
        max-width:1200px;
        margin:0 auto;
  ">

      <!-- LEFT: logo (click goes to movies) -->
      <a th:href="@{/movies}" style="display:flex; align-items:center; gap:0.6rem; text-decoration:none;">
        <div style="
              width:36px;
              height:36px;
              border-radius:8px;
              background:linear-gradient(135deg,#4f8cff,#1d4ed8);
              box-shadow:0 8px 16px rgba(0,0,0,0.4);
        " aria-hidden="true"></div>

        <span style="font-weight:700; font-size:1.05rem; color:white;">
          MovieApp
        </span>
      </a>

      <!-- CENTER NAV: Movies + Add Movie (Add Movie visible only to ADMIN) -->
      <nav style="text-align:center; display:flex; gap:1rem; align-items:center; margin-left:auto; margin-right:auto;">
        <a th:href="@{/movies}"
           style="color:white; font-weight:600; text-decoration:none; padding:8px 12px; opacity:0.95;">
          Movies
        </a>

        <span sec:authorize="hasRole('ADMIN')">
          <a th:href="@{/movies/new}"
             style="color:white; font-weight:600; text-decoration:none; padding:8px 12px; background: rgba(255,255,255,0.04); border-radius:8px;">
            Add Movie
          </a>
        </span>
      </nav>

      <!-- RIGHT: auth links / profile -->
      <div style="display:flex; align-items:center; gap:0.75rem;">

        <!-- NOT LOGGED IN -->
        <span sec:authorize="!isAuthenticated()">
          <a th:href="@{/login}" style="color:white; font-weight:600; text-decoration:none; opacity:0.95;">Login</a>
          <span style="color:white; opacity:0.45;">|</span>
          <a th:href="@{/register}" style="color:white; font-weight:600; text-decoration:none; opacity:0.95;">Register</a>
        </span>

        <!-- LOGGED IN -->
        <span sec:authorize="isAuthenticated()" style="display:flex; align-items:center; gap:0.6rem; color:white;">
          <span style="color:rgba(255,255,255,0.75); font-weight:600;">Hello,</span>
          <strong sec:authentication="name" style="font-weight:700; color:white;"></strong>

          <!-- optional quick profile icon linking to /profile or /users/me -->
          <a th:href="@{/profile}" style="display:inline-block; width:36px; height:36px; border-radius:8px; background:linear-gradient(135deg,#60a5fa,#1e40af); text-align:center; color:white; line-height:36px; text-decoration:none; font-weight:700;" sec:authorize="isAuthenticated()">P</a>

          <form th:action="@{/logout}" method="post" style="display:inline;">
            <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />
            <button type="submit"
                    style="background:none; border:1px solid rgba(255,255,255,0.45);
                           padding:6px 10px; border-radius:6px; color:white; cursor:pointer;">
              Logout
            </button>
          </form>
        </span>

      </div>

  </div>
</header>
  
  <!-- FOOTER FRAGMENT -->
  <footer class="site-footer" th:fragment="siteFooter" role="contentinfo" style="padding-top:18px; padding-bottom:18px;">
    <div class="container" style="text-align:center;">
      <small style="color:var(--muted);">Â© <span th:text="${#dates.format(#dates.createNow(),'yyyy')}">2025</span> MovieApp</small>
    </div>
  </footer>

</body>
</html>
